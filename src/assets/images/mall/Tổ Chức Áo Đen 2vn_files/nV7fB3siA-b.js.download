if (self.CavalryLogger) { CavalryLogger.start_js(["3oePu"]); }

__d("MAbstractButton.react",["cx","React","joinClasses","prop-types"],(function(a,b,c,d,e,f,g){"use strict";var h=b("React");a=function(a){babelHelpers.inheritsLoose(c,a);function c(){var b,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(b=c=a.call.apply(a,[this].concat(e))||this,c.handleLinkClick=function(a){c.props.disabled?a.preventDefault():c.props.onClick&&c.props.onClick(a)},b)||babelHelpers.assertThisInitialized(c)}var d=c.prototype;d.render=function(){var a="_2c65"+(this.props.disabled?" _2c66":"")+(this.props.depressed?" _2c67":""),c,d=this.props.image;d&&(c={},this.props.label&&!this.props.labelIsHidden&&(c.alt="",c.className=b("joinClasses")(d.props.className,"_3-90")),d=h.cloneElement(d,c));var e=this.props.imageRight;e&&(c={},this.props.label&&!this.props.labelIsHidden&&(c.alt="",c.className=b("joinClasses")(e.props.className,"_3-9a")),e=h.cloneElement(e,c));this.props.href?c=h.jsxs("a",babelHelpers["extends"]({},this.props,{className:b("joinClasses")(this.props.className,a),label:null,href:this.props.href,onClick:this.handleLinkClick,children:[d,this.props.labelIsHidden?h.jsx("span",{className:"accessible_elem",children:this.props.label}):this.props.label,e]})):this.props.type&&this.props.type!=="submit"?c=h.jsxs("button",babelHelpers["extends"]({},this.props,{className:b("joinClasses")(this.props.className,a),label:null,type:this.props.type,children:[d,this.props.labelIsHidden?h.jsx("span",{className:"accessible_elem",children:this.props.label}):this.props.label,e]})):c=h.jsxs("button",babelHelpers["extends"]({},this.props,{className:b("joinClasses")(this.props.className,a),type:"submit",label:null,value:"1",children:[d,this.props.labelIsHidden?h.jsx("span",{className:"accessible_elem",children:this.props.label}):this.props.label,e]}));return c};return c}(h.Component);e.exports=a;a.propTypes={image:(c=b("prop-types")).element,imageRight:c.element,depressed:c.bool,disabled:c.bool,type:c.string,href:c.string,label:c.node,labelIsHidden:c.bool,onClick:c.func}}),null);
__d("MFullScreen",[],(function(a,b,c,d,e,f){a={debounce:function(a,b,c){var d;return function(){var e=this,f=arguments,g=function(){d=null,c||a.apply(e,f)},h=c&&!d;window.clearTimeout(d);d=window.setTimeout(g,b);h&&a.apply(e,f)}},isSupported:function(){var a=document.webkitFullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled||document.fullscreenEnabled,b=document.webkitCancelFullScreen||document.mozCancelFullScreen||document.msExitFullscreen||document.cancelFullScreen||document.exitFullScreen;return a&&b},isFullScreen:function(){return document.webkitIsFullScreen||document.fullScreen||document.mozFullScreen||document.msFullscreenElement||document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement},enableFullScreen:function(a){a.webkitRequestFullScreen?a.webkitRequestFullScreen():a.mozRequestFullScreen?a.mozRequestFullScreen():a.msRequestFullscreen?a.msRequestFullscreen():a.requestFullScreen?a.requestFullScreen():a.requestFullscreen?a.requestFullscreen():a.webkitRequestFullscreen&&a.webkitRequestFullscreen()},disableFullScreen:function(){if(document.webkitCancelFullScreen){document.webkitCancelFullScreen();return!0}else if(document.mozCancelFullScreen){document.mozCancelFullScreen();return!0}else if(document.msExitFullscreen){document.msExitFullscreen();return!0}else if(document.cancelFullScreen){document.cancelFullScreen();return!0}else if(document.exitFullScreen){document.exitFullScreen();return!0}return!1},isVideoExitFullScreenSupported:function(){if(this.isSupported())return!0;return HTMLVideoElement&&HTMLVideoElement.prototype&&"webkitExitFullScreen"in HTMLVideoElement.prototype?!0:!1},videoExitFullScreen:function(a){this.disableFullScreen()||a.webkitExitFullScreen&&a.webkitExitFullScreen()},listenForFullScreenEvent:function(a,b){var c=this.debounce(b,500),d=["webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange","fullscreenchange"];d.forEach(function(b){return a.addEventListener(b,c)});return{remove:function(){d.forEach(function(b){return a.removeEventListener(b,c)})}}},removeFullScreenEventListeners:function(a,b){var c=this.debounce(b,500);a.removeEventListener("webkitfullscreenchange",b);a.removeEventListener("mozfullscreenchange",b);a.removeEventListener("MSFullscreenChange",b);a.removeEventListener("fullscreenchange",c)}};e.exports=a}),null);
__d("mergeHelpers",["invariant","FbtResultBase"],(function(a,b,c,d,e,f,g){"use strict";var h=36,i=function(a){return typeof a!=="object"||a instanceof Date||a===null||a instanceof b("FbtResultBase")},j={MAX_MERGE_DEPTH:h,isTerminal:i,normalizeMergeArg:function(a){return a==null?{}:a},checkMergeArrayArgs:function(a,b){Array.isArray(a)&&Array.isArray(b)||g(0,3714,a,b)},checkMergeObjectArgs:function(a,b){j.checkMergeObjectArg(a),j.checkMergeObjectArg(b)},checkMergeObjectArg:function(a){!i(a)&&!Array.isArray(a)||g(0,3715,a)},checkMergeIntoObjectArg:function(a){(!i(a)||typeof a==="function")&&!Array.isArray(a)||g(0,3716,a)},checkMergeLevel:function(a){a<h||g(0,3717)},checkArrayStrategy:function(a){a==null||a in j.ArrayStrategies||g(0,3718)},ArrayStrategies:{Clobber:"Clobber",Concat:"Concat",IndexByIndex:"IndexByIndex"}};a=j;e.exports=a}),null);
__d("mergeDeepInto",["invariant","mergeHelpers"],(function(a,b,c,d,e,f,g){"use strict";e.exports=a;var h=(c=b("mergeHelpers")).ArrayStrategies,i=c.checkArrayStrategy,j=c.checkMergeArrayArgs,k=c.checkMergeLevel,l=c.checkMergeObjectArgs,m=c.isTerminal,n=c.normalizeMergeArg,o=function(a,b,c,d){l(a,b);k(d);var e=b?Object.keys(b):[];for(var f=0;f<e.length;f++){var g=e[f];q(a,b,g,c,d)}},p=function(a,b,c,d){j(a,b);k(d);if(c===h.Concat)a.push.apply(a,b);else{var e=Math.max(a.length,b.length);for(var f=0;f<e;f++)q(a,b,f,c,d)}},q=function(a,b,c,d,e){var f=b[c];b=Object.prototype.hasOwnProperty.call(b,c);var i=b&&m(f),j=b&&Array.isArray(f),k=b&&!j&&!j,l=a[c],n=Object.prototype.hasOwnProperty.call(a,c),q=n&&m(l),r=n&&Array.isArray(l),s=n&&!r&&!r;q?i?a[c]=f:j?(a[c]=[],p(a[c],f,d,e+1)):k?(a[c]={},o(a[c],f,d,e+1)):b||(a[c]=l):r?i?a[c]=f:j?(d&&h[d]||g(0,5117),d===h.Clobber&&(l.length=0),p(l,f,d,e+1)):k?(a[c]={},o(a[c],f,d,e+1)):!b:s?i?a[c]=f:j?(a[c]=[],p(a[c],f,d,e+1)):k?o(l,f,d,e+1):!b:n||(i?a[c]=f:j?(a[c]=[],p(a[c],f,d,e+1)):k?(a[c]={},o(a[c],f,d,e+1)):!b)};function a(a,b,c){b=n(b);i(c);o(a,b,c,0)}}),null);
__d("AsyncStorage",["Deferred","mergeDeepInto","mergeHelpers"],(function(a,b,c,d,e,f){"use strict";var g=b("mergeHelpers").ArrayStrategies,h=window.indexedDB,i=1,j="data",k=!1,l;c=Date.now();var m=new(b("Deferred"))();function a(){var a=h.open("AsyncStorage",i);a.onerror=function(a){a=new Error("Failed to open AsyncStorage IndexedDB instance.");m.reject(a)};a.onsuccess=function(a){k&&!1,l=a.target.result,m.resolve({db:l}),l.onerror=function(a){a=new Error("AsyncStorage error: "+a.target.error.message);m.reject(a)}};a.onupgradeneeded=function(a){a=a.currentTarget.result;if(a.objectStoreNames&&a.objectStoreNames.contains(j))return;a.createObjectStore(j,{keyPath:"key"})}}h&&a();function n(a,b){if(l)try{a()}catch(a){b&&b(a)}else m.getPromise().then(function(){k&&!1,n(a,b)},function(a){b&&b(a)})}d={setItem:function(a,b,c){this.multiSet([[a,b]],function(a){c(a&&a[0]||null)})},getItem:function(a,b){this.multiGet([a],function(a,c){c=c!==void 0&&c[0]!==void 0&&c[0][1]!==void 0?c[0][1]:null;b(a&&a[0]||null,c)})},removeItem:function(a,b){this.multiRemove([a],function(a){b(a&&a[0]||null)})},multiGet:function(a,b){var c=[];this._multiOp(a,"readonly",function(a){return b(a,c)},function(a){return a},function(a,b,d){b&&a===b.key?(k&&!1,c.push([a,b.value.value])):c.push([a,null])})},multiSet:function(a,b){if(this._persistentWritesDisabled){b(new Array(a.length).fill("writes disabled"));return}this._multiOp(a,"readwrite",b,function(a){return a[0]},function(a,b,c){if(b&&a[0]===b.key){var d=b.value;d.value=a[1];k&&!1;b.update(d)}else c.push(a)})},multiMerge:function(a,c){this._multiOp(a,"readwrite",c,function(a){return a[0]},function(a,c,d){if(c&&a[0]===c.key){var e=c.value,f=JSON.parse(e.value);b("mergeDeepInto")(f,JSON.parse(a[1]),g.Clobber);k&&!1;e.value=JSON.stringify(f);c.update(e)}else k&&!1,d.push(a)})},multiRemove:function(a,b){this._multiOp(a,"readwrite",b,function(a){return a},function(a,b,c){b&&a===b.key&&(k&&!1,b["delete"]())})},getAllKeys:function(a){n(function(){var b=l.transaction([j],"readonly");b=b.objectStore(j).openCursor();var c=[];b.onsuccess=function(b){b=b.target.result;if(!b){a(null,c);return}c.push(b.key);b["continue"]()}},function(){return a(null,[])})},clear:function(a){n(function(){var b=l.transaction([j],"readwrite");b=b.objectStore(j).openCursor();b.onsuccess=function(b){b=b.target.result;if(!b){a(null);return}b["delete"]();b["continue"]()}},function(){return a(null)})},_multiOp:function(a,b,c,d,e){n(function(){var f=!1,g=a.slice().sort(function(a,b){a=d(a);b=d(b);if(a===b){var e=new Error("AsyncStorage._multiOp cannot process duplicate keys.");c&&c([e]);f=!0;return 0}return a<b?-1:1});if(f)return;var h=l.transaction([j],b),i=h.objectStore(j).openCursor(),m=[],n=0;i.onsuccess=function(a){a=a.target.result;if(!a){while(n<g.length)e(g[n],a,m),n++;o();return}var b=a.key;k&&!1;while(d(g[n])<=b){k&&!1;e(g[n],a,m);n++;if(n===g.length){o();return}}b=d(g[n]);a["continue"](b)};function o(){var a=h.objectStore(j);m.forEach(function(b){k&&!1,a.add({key:b[0],value:b[1]})})}h.oncomplete=function(){c&&c(null)};h.onerror=function(a){a=new Error("IndexedDB error: "+a.target.error.message);c&&c([a])};k&&!1},function(a){c&&c([a])})},_persistentWritesDisabled:!1,disablePersistentWrites:function(){this._persistentWritesDisabled=!0}};e.exports=d}),null);
__d("MVideoCacheConfig",["CurrentUser","MVideoDownloadConfig","md5","WebStorage"],(function(a,b,c,d,e,f){var g,h=null,i={CACHE_PREFIX:"vc",PREFIX_SEPARATOR:"_",CONFIG_PREFIX:"config",KEYS:{lastCleanUp:"lastCleanUp"},isSupported:function(){try{h||(h=g||(g=b("WebStorage")));return h.getLocalStorage()}catch(a){h=null;return!1}},currentAccountHash:function(){var a=""+b("CurrentUser").getAccountID();return b("md5")(a)},getUserPrefix:function(){return i.CACHE_PREFIX+i.PREFIX_SEPARATOR+i.currentAccountHash()+i.PREFIX_SEPARATOR},getCacheConfigKey:function(){return i.CACHE_PREFIX+i.PREFIX_SEPARATOR+i.CONFIG_PREFIX+i.PREFIX_SEPARATOR+i.currentAccountHash()},initCacheConfig:function(){var a={},c=Date.now()-2*b("MVideoDownloadConfig").cache_sync_interval_ms;a[i.KEYS.lastCleanUp]=c;a=JSON.stringify(a);c=i.getCacheConfigKey();h.getLocalStorage().setItem(c,a);return a},getCacheConfig:function(){var a=i.getCacheConfigKey();a=h.getLocalStorage().getItem(a);try{JSON.parse(a)}catch(b){a=null}a===null&&(a=i.initCacheConfig());a=JSON.parse(a);return a},getItemFromConfig:function(a){var b=i.getCacheConfig();return b[a]},setItemFromConfig:function(a,b){var c=i.getCacheConfig();c[a]=b;c=JSON.stringify(c);a=i.getCacheConfigKey();h.getLocalStorage().setItem(a,c)}};e.exports=i}),null);
__d("XHRRequestRetrier",["setTimeoutAcrossTransitions"],(function(a,b,c,d,e,f){a=function(){function a(a){this.$1=a,this.$2=!1,this.$3=0,this.$4=0,this.$5=0,this.$6=1e3,this.$7=2,this.$8=.5,this.$9=a.getErrorHandler(),a.setErrorHandler(this.$11.bind(this)),this.$10=a.getAbortHandler(),a.setAbortHandler(this.$12.bind(this))}var c=a.prototype;c.setMaxAttempts=function(a){this.$5=a;return this};c.setBaseRetryDelayMs=function(a){this.$6=a;return this};c.setRetryBackoffFactor=function(a){this.$7=a;return this};c.setRetryFuzzFactor=function(a){this.$8=a;return this};c.send=function(){if(this.$2)return;if(this.$1.getTimeout())throw new Error("Not supported.");this.$3++;this.$4||(this.$4=this.$6);this.$1.send()};c.$11=function(){this.$3<this.$5?this.$13():this.$9&&this.$9.apply(this,arguments)};c.$12=function(){this.$2=!0,this.$10&&this.$10.apply(this,arguments)};c.$13=function(){var a=this.send.bind(this),c=Math.random()*2-1;c=c*this.$8;c=this.$4*(1+c);b("setTimeoutAcrossTransitions")(a,c);this.$4*=this.$7};return a}();e.exports=a}),null);
__d("URIDownloader",["invariant","URI","XHRRequest","XHRRequestRetrier"],(function(a,b,c,d,e,f,g){var h,i=2e5,j=15,k=2e3,l=1.5;a=function(){function a(a,c){this.$1=new(h||(h=b("URI")))(a),this.$2=c,this.$3=0,this.$4=0,this.$5=[]}var c=a.prototype;c.setResponseHandler=function(a){this.$10&&g(0,3234);this.$9=a;return this};c.setChunkedResponseHandler=function(a){this.$9&&g(0,3235);this.$10=a;return this};c.setErrorHandler=function(a){this.$11=a;return this};c.setAbortHandler=function(a){this.$12=a;return this};c.setProgressHandler=function(a){this.$13=a;return this};c.$14=function(a){if(this.$8)return;this.$13&&this.$13({total:this.$2,loaded:this.$4+(a?a:0)})};c.$15=function(){if(this.$8)return;if(this.$9){var a=null;this.$5&&(a=new Blob(this.$5));this.$9(a)}this.$10&&this.$10(this.$5)};c.$16=function(a){if(this.$8)return;this.$17(a)?this.$4<this.$2?(this.$14(),this.$18()):this.$15():this.$19()};c.$19=function(){if(this.$8)return;this.$11&&this.$11()};c.$20=function(){if(this.$8)return;this.$12&&this.$12()};c.$21=function(){var a=Math.min(this.$4+i,this.$2);this.$3=a-this.$4};c.$17=function(a){if(this.$8)return!1;if(this.$3!==a.size)return!1;this.$5.push(a);this.$4+=this.$3;this.$3=0;return!0};c.$18=function(){var a=this;if(this.$8)return;var c=new(b("XHRRequest"))(this.$1).setMethod("GET").setResponseType("blob").setResponseHandler(this.$16.bind(this)).setErrorHandler(this.$19.bind(this)).setAbortHandler(this.$20.bind(this)).setDownloadProgressHandler(function(b){b.loadedBytes&&a.$14(b.loadedBytes)});this.$21();c.setRequestHeader("Range","bytes="+this.$4+"-"+(this.$4+this.$3-1));this.$7=c;c=new(b("XHRRequestRetrier"))(c).setMaxAttempts(j).setBaseRetryDelayMs(k).setRetryBackoffFactor(l);this.$6=c;try{c.send()}catch(a){this.$19()}};c.sendRequest=function(){this.$4=0,this.$18()};c.abort=function(){this.$8=!0,this.$7&&this.$7.abort?this.$7.abort():this.$12&&this.$12(),this.$22()};c.$22=function(){this.$7=null,this.$5=null,this.$12=null,this.$11=null,this.$9=null,this.$13=null};return a}();e.exports=a}),null);
__d("XVideoDownloadEventController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/video_download_event/",{video_id:{type:"Int",required:!0},viewer_id:{type:"Int",required:!0},app_id:{type:"Int",required:!0},event:{type:"Enum",required:!0,enumType:1}})}),null);
__d("VideoDownloadEventHandler",["CurrentUser","DataAttributeUtils","MRequest","XVideoDownloadEventController"],(function(a,b,c,d,e,f){var g=412378670482;a=function(){function a(a,b,c){this.$1=a,this.$2=b,this.$3=c}var c=a.prototype;c.sendServerDownloadEvent=function(){var a=b("XVideoDownloadEventController").getURIBuilder().setInt("video_id",this.$1).setInt("viewer_id",b("CurrentUser").getAccountID()).setInt("app_id",g).setEnum("event",this.$3).getURI(),c=null;this.$2&&(c=b("DataAttributeUtils").getDataFt(this.$2));new(b("MRequest"))(a).setMethod("POST").setData({ft_data:c}).send()};return a}();e.exports=a}),null);
__d("VideoDownloadLogger",["Bootloader","CurrentUser","md5"],(function(a,b,c,d,e,f){var g=null,h=null,i=2147483647,j="video_download";function k(){return Date.now()}a=function(){"use strict";function a(a){a=a?a:{},this.$1=a}var c=a.prototype;c.$2=function(a,b){b=babelHelpers["extends"]({},b,this.$1);!a;Object.prototype.hasOwnProperty.call(b,"time_ms")||(b.time_ms=k());Object.prototype.hasOwnProperty.call(b,"connectivity_type")||(b.connectivity_type=h.getConnectivityType());b={logData:b,event:a};g.post(j,b)};c.logEvent=function(a,c){!g||!h?b("Bootloader").loadModules(["Banzai","MVideoUtils"],function(b,d){g=b,h=d,this.$2(a,c)}.bind(this),"VideoDownloadLogger"):this.$2(a,c)};a.time=function(){return Math.floor(Date.now()/1e3)};a.generateSessionID=function(){return b("md5")([b("CurrentUser").getID(),a.time(),Math.random()*i].join(":"))};return a}();e.exports=a}),null);
__d("MVideoCache",["MLegacyDataStore","MVideoCacheConfig","MVideoDownloadConfig","URIDownloader","VideoDownloadEventHandler","VideoDownloadLogger","emptyFunction","AsyncStorage","WebStorage"],(function(a,b,c,d,e,f){var g,h=null,i=null,j={},k=500,l=4e9,m=0,n={audio:"audio",video:"video"},o=function(){"use strict";function a(a,b){this.$1=a,this.$2=b,a.chunked?this.$3=b===n.video?a.videoChunkCount:a.audioChunkCount:this.$3=1,this.$4=0}var b=a.prototype;b.getNextBuffer=function(a){if(this.$4>=this.$3)a(null);else{var b=this.$4++;p.getCachedStream(this.$1,this.$2,function(b){a(b)},a,this.$1.chunked?b:null)}};return a}(),p={DEFAULT_QUALITY_TAG:"default",DOWNLOAD_STARTED_TIME:"downloadStartedTime",DOWNLOAD_REASON:"downloadReason",OFFLINE_LIFESPAN:"offlineLifespan",VIEW_COUNT:"viewCount",RESOURCE_STATE:{loading:"loading",finished:"finished",error:"error"},ERROR:{QUOTA_EXCEEDED:1,NO_ACCESS:2},isDownloadInProgress:function(){return!p.isEmptyObject(j)},isSupported:function(){try{h||(h=b("AsyncStorage"));i||(i=g||(g=b("WebStorage")));return i.getLocalStorage()&&window.indexedDB&&navigator.webkitTemporaryStorage&&navigator.webkitTemporaryStorage.queryUsageAndQuota}catch(a){h=null;i=null;return!1}},downloadVideo:function(a,b,c,d,e,f,g,h,i){g===void 0&&(g={});h===void 0&&(h="user_initiated");i===void 0&&(i=null);var j=JSON.parse(b),k=p.createVideoResource(j,f),l=p.createAudioResource(j,f);if(!k&&!l){d();return}var m=[];k&&m.push(k);l&&m.push(l);m=p.calculateTotalSize(b,f);var n=p.createTracking(a,m,j.offline_lifespan_ms,c,d,e,f,g.origin,h,i);if(!n){d();return}b={};b.event_origin=g.origin;b.event_suborigin=g.suborigin;p.logEventTracking(n,"download_requested",b);p.flushAsyncStorage(function(){navigator.webkitTemporaryStorage.queryUsageAndQuota(function(a,b){var c=p.getTotalSizeOfLoadingResources();if(a+n.totalSize+c<p.getMaxCacheUsage()&&n.totalSize+c+p.getMinFreeSpace()<b)p.downloadPostQuotaCheck(n,k,l);else{c="Used: "+a+" Remaining: "+b+" MaxCacheUsage: "+p.getMaxCacheUsage()+" MinFreeSpace: "+p.getMinFreeSpace();p.onError(n,p.ERROR.QUOTA_EXCEEDED,c)}},function(){p.onError(n,p.ERROR.QUOTA_EXCEEDED)})})},getDownloadNotificationUri:function(a){a=JSON.parse(a);return a&&a.download_finished_notification_uri},deleteVideoByID:function(a,c,d,e){e===void 0&&(e={});c=c?c:b("emptyFunction");var f=p.getTracking(a),g={};g.event_origin=e.origin;g.event_suborigin=e.suborigin;g.reason=d||"user_initiated";if(f)p.logEventTracking(f,"download_cancelled",g),p.deleteTracking(f,!0);else{p.logEvent(a,"download_deleted",g);e=new(b("VideoDownloadEventHandler"))(a,null,"download_deleted");e.sendServerDownloadEvent()}p.deleteCachedVideoFromStorage(a,c)},calculateTotalSize:function(a,b){a=JSON.parse(a);a=p.getStreamsForQuality(a,b);return a&&p.calculateTotalSizeInState(a,void 0)},getQualitiesFromResources:function(a){a=JSON.parse(a);a=a&&a.streams;if(!a)return null;var b=null,c={};for(var d=0;d<a.length;d++){var e=a[d],f=String(e.mimetype);if(f&&f.startsWith(n.video)){var g=Object.prototype.hasOwnProperty.call(e,"quality")&&String(e.quality);g&&(c[g]=e.size)}else f&&f.startsWith(n.audio)&&(b=e)}if(b)for(var h in c)Object.prototype.hasOwnProperty.call(c,h)&&c[h]&&(c[h]+=b.size);return c},deleteVideosByID:function(a,b,c){if(p.isSupported())for(var d=0;d<a.length;d++){var e=a[d];p.deleteVideoByID(e,function(){b(e)},c)}},isVideoDownloaded:function(a){if(p.isSupported()){a=p.getCachedVideoByID(a);if(a)return!0;else return!1}return!1},isVideoDownloading:function(a){return p.isSupported()?j&&j[a]:!1},getVideoSize:function(a,b,c){if(p.isSupported()){var d=p.getTracking(a);if(d)return d.totalSize;d=p.getCachedVideoByID(a);if(d)return d.totalSize;if(b){a=p.calculateTotalSize(b,c);if(a&&a>0)return a}}return null},getVideoProgressByID:function(a){if(p.isSupported()){a=p.getTracking(a);if(a)return a.loaded}return 0},_fillMissingFieldsWithDefaults:function(a,c){for(var d=0;d<c.length;d++){var e=c[d];e===p.DOWNLOAD_STARTED_TIME&&!Object.prototype.hasOwnProperty.call(a,e)&&(a.downloadStartedTime=0);e===p.DOWNLOAD_REASON&&!Object.prototype.hasOwnProperty.call(a,e)&&(a.downloadReason="user_initiated");e===p.OFFLINE_LIFESPAN&&!Object.prototype.hasOwnProperty.call(a,e)&&(a.offlineLifespan=b("MVideoDownloadConfig").cache_default_offline_lifespan_ms)}return a},getCachedVideoByID:function(a){if(!b("MVideoDownloadConfig").enabled&&!b("MVideoDownloadConfig").simulate_legacy_ux)return null;var c=p.createPrefix(a),d=null;try{d=i.getLocalStorage().getItem(c)}catch(a){}c=d&&JSON.parse(d);c=c&&p._fillMissingFieldsWithDefaults(c,[p.DOWNLOAD_STARTED_TIME,p.DOWNLOAD_REASON,p.OFFLINE_LIFESPAN]);if(b("MVideoDownloadConfig").simulate_legacy_ux)return null;if(c&&c.chunked&&!b("MVideoDownloadConfig").cache_chunked_playback_enabled){setTimeout(function(){p.deleteVideoByID(a,b("emptyFunction"),"chunked_playback_not_supported")},0);return null}return c},getCachedVideosMetadata:function(a,c){a===void 0&&(a=[]);c===void 0&&(c=!1);var d={};if(!p.isSupported())return d;var e=i.getLocalStorage(),f=Object.keys(e),g=b("MVideoCacheConfig").getUserPrefix();for(var h in f)if(Object.prototype.hasOwnProperty.call(f,h)&&f[h]&&f[h].startsWith(g)){var j=p.getVideoIDFromStorageKey(f[h]),k={};if(a.length>0){var l=null;try{l=e.getItem(f[h])}catch(a){if(!c)continue}l=l&&JSON.parse(l);if((!l||l.chunked&&!b("MVideoDownloadConfig").cache_chunked_playback_enabled)&&!c)continue;for(var m=0;m<a.length;m++){var n=a[m];l&&n in l&&(k[n]=l[n])}k=p._fillMissingFieldsWithDefaults(k,a)}d[j]=k}return d},getCachedVideoIDs:function(a){a===void 0&&(a=!1);return Object.keys(p.getCachedVideosMetadata([],a))},hasDownloadedVideos:function(){var a=p.getCachedVideoIDs();return a&&a.length&&a.length>0},getDownloadingVideos:function(){var a=Object.keys(j);return a},getVideoIDFromStorageKey:function(a){var c=b("MVideoCacheConfig").PREFIX_SEPARATOR;return a.split(c)[2]||""},getCachedVideo:function(a){a=b("MLegacyDataStore").get(a);return p.getCachedVideoByID(a.videoID)},getCachedVideoStream:function(a,b,c){p.getCachedStream(a,n.video,b,c)},getCachedAudioStream:function(a,b,c){p.getCachedStream(a,n.audio,b,c)},getCachedVideoStreamObject:function(a){return new o(a,n.video)},getCachedAudioStreamObject:function(a){return new o(a,n.audio)},getMaxCacheUsage:function(){var a=l;b("MVideoDownloadConfig")&&Object.prototype.hasOwnProperty.call(b("MVideoDownloadConfig"),"max_cache_usage")&&(a=b("MVideoDownloadConfig").max_cache_usage);return a},getMinFreeSpace:function(){var a=m;b("MVideoDownloadConfig")&&Object.prototype.hasOwnProperty.call(b("MVideoDownloadConfig"),"min_free_space")&&(a=b("MVideoDownloadConfig").min_free_space);return a},downloadPostQuotaCheck:function(a,b,c){if(!p.addTracking(a)){p.onError(a);return}b&&p.sendResourceRequest(a,b);c&&p.sendResourceRequest(a,c)},calculateTotalSizeInState:function(a,b){var c,d=0,e=a.length;for(c=0;c<e;c++){var f=a[c];(!b||f.state===b)&&(d+=f.size)}return d},isEmptyObject:function(a){for(var b in a)if(Object.prototype.hasOwnProperty.call(a,b)&&a[b])return!1;return!0},getTotalSizeOfLoadingResources:function(){var a=0;for(var b in j)if(Object.prototype.hasOwnProperty.call(j,b)&&j[b]){var c=j[b];a+=p.calculateTotalSizeInState(c.resources,p.RESOURCE_STATE.loading)}return a},deleteCachedVideoFromStorage:function(a,b){a=p.createPrefix(a);try{i.getLocalStorage().removeItem(a)}catch(a){}p.getObjectKeysFromAsyncStorageByPrefix(a,function(a,c){if(a||!c){b();return}try{h.multiRemove(c,function(){b()})}catch(a){b()}})},flushAsyncStorage:function(a){var b=p.createPrefix(0),c=["0"];c=new Blob(c,{type:"text/html"});try{h.setItem(b,c,function(){try{h.removeItem(b,function(){a()})}catch(b){a()}})}catch(c){try{h.removeItem(b,function(){a()})}catch(b){a()}}},getObjectKeysFromAsyncStorageByPrefix:function(a,b){try{h.getAllKeys(function(c,d){if(c||!d){b(c);return}d=d.filter(function(b){return b.startsWith(a)});b(null,d)})}catch(a){b(a)}},getVideosFromAsyncStorage:function(a){p.getObjectKeysFromAsyncStorageByPrefix(b("MVideoCacheConfig").getUserPrefix(),function(b,c){if(b||!c){a(b);return}b=c.map(p.getVideoIDFromStorageKey);c=b.reduce(function(a,b){a[b]=!0;return a},{});a(null,Object.keys(c))})},makeLocalAsyncStorageConsistent:function(a,b){var c=p.getCachedVideoIDs(!0);p.getVideosFromAsyncStorage(function(d,e){if(d||!e){a();return}var f={};d=c.concat(e);d.forEach(function(a){!f[a]?f[a]=1:f[a]++});f=Object.keys(f).filter(function(a){return f[a]===1});f.length>0&&p.deleteVideosByID(f,b,"consistency_check");a()})},getCachedStream:function(a,b,c,d,e){b=p.createPrefix(a.videoID,b,e);try{h.getItem(b,function(b,e){b?(p.deleteVideoByID(a.videoID),d()):c(e)})}catch(b){p.deleteVideoByID(a.videoID),d()}},saveVideoInLocalStorage:function(a){var b=a.videoID&&p.createPrefix(a.videoID);try{i.getLocalStorage().setItem(b,JSON.stringify(a))}catch(a){throw a}},saveCachedVideo:function(a){var b={};b.downloadStartedTime=a.downloadStartedTime;b.downloadReason=a.downloadReason;b.videoID=a.videoID;b.quality=a.quality;b.audioCodec=p.getResourceCodec(a,n.audio);b.videoCodec=p.getResourceCodec(a,n.video);b.totalSize=a.totalSize;b.offlineLifespan=a.offlineLifespan;b.viewCount=0;b.sessionID=a.sessionID;b.downloadOrigin=a.origin;b.chunked=a.chunked;b.videoChunkCount=a.videoChunkCount;b.audioChunkCount=a.audioChunkCount;p.saveVideoInLocalStorage(b)},logPlaybackRequest:function(a,b,c){var d=null;if(b){b=p.getCachedVideoByID(a);var e=b.viewCount||0;b.viewCount=e+1;p.saveVideoInLocalStorage(b)}else d=p.ERROR.NO_ACCESS;e={};e.error_code=d;e.reason=c;p.logEvent(a,"requested_playing",e)},createPrefix:function(a,c,d){a=b("MVideoCacheConfig").getUserPrefix()+a+b("MVideoCacheConfig").PREFIX_SEPARATOR+p.DEFAULT_QUALITY_TAG;c&&(a=a+b("MVideoCacheConfig").PREFIX_SEPARATOR+c);d!=void 0&&d!=null&&(a=a+b("MVideoCacheConfig").PREFIX_SEPARATOR+d);return a},createResource:function(a,b,c,d){var e={};e.src=a;e.type=b;e.state=p.RESOURCE_STATE.loading;e.codec=c;e.size=d;e.progress=0;return e},getDefaultVideoStream:function(a){var b=null;for(var c=0;c<a.length;c++){var d=a[c],e=String(d.mimetype);if(e&&e.startsWith(n.video)){b=d;if(d["default"])return d}}return b},getStreamsForQuality:function(a,b){var c=[];a=a&&a.streams;var d=!1,e=!1;for(var f=0;f<a.length;f++){var g=a[f],h=String(g.mimetype);if(h&&h.startsWith(n.video)&&!d){var i=String(g.quality);b&&i&&i===b&&(d=!!c.push(g))}else h&&h.startsWith(n.audio)&&!e&&(e=!!c.push(g))}if(!d){i=p.getDefaultVideoStream(a);i&&c.push(i)}return c},getUrlInfo:function(a,b,c){a=p.getStreamsForQuality(a,c);if(!a)return null;c=null;for(var d=0;d<a.length;d++){var e=a[d],f=String(e.mimetype);if(f&&f.startsWith(b)){c=e;break}}return c},createVideoResource:function(a,b){a=p.getUrlInfo(a,n.video,b);return a&&p.createResource(a.url,n.video,a.codecs,a.size)},createAudioResource:function(a,b){a=p.getUrlInfo(a,n.audio,b);return a&&p.createResource(a.url,n.audio,a.codecs,a.size)},addTracking:function(a){if(j[a.videoID])return!1;j[a.videoID]=a;return!0},createTracking:function(a,c,d,e,f,g,h,i,j,k){var l={};l.videoID=a;l.quality=h||p.DEFAULT_QUALITY_TAG;l.onDone=e;l.onError=f;l.onProgress=g;l.resources=[];l.deleted=!1;l.loaded=0;l.totalSize=c;l.offlineLifespan=d;l.sessionID=b("VideoDownloadLogger").generateSessionID();l.origin=i;l.logger=p.createLogger(l);l.downloadStartedTime=Date.now();l.chunked=b("MVideoDownloadConfig").cache_chunked_storage_enabled;l.loggingDataCallback=k;l.downloadReason=j;return l},getTracking:function(a){return j[a]},deleteTracking:function(a,b){var c={};c.reason=a.downloadReason;if(!a.deleted){a.deleted=!0;j[a.videoID]=null;if(b){for(b=0;b<a.resources.length;b++)try{a.resources[b].downloader&&a.resources[b].downloader.abort()}catch(b){p.logEventTracking(a,"download_failed",c)}}}},getResourceCodec:function(a,b){var c,d,e;e=a.resources.length;for(d=0;d<e;d++){c=a.resources[d];if(c.type===b)return c.codec}return null},updateTracking:function(a,b,c){var d,e;if(a.deleted)return;c&&(b.state=c);b.state===p.RESOURCE_STATE.finished&&(b.type===n.video?a.videoChunkCount=b.chunkCount:b.type===n.audio&&(a.audioChunkCount=b.chunkCount));if(b.state===p.RESOURCE_STATE.loading)a.resources.push(b);else{c=p.RESOURCE_STATE.finished;b=a.resources.length;for(d=0;d<b;d++){e=a.resources[d];if(e.state===p.RESOURCE_STATE.loading){c=p.RESOURCE_STATE.loading;break}else e.state===p.RESOURCE_STATE.error&&(c=p.RESOURCE_STATE.error)}if(c===p.RESOURCE_STATE.error)p.deleteTracking(a),p.deleteCachedVideoFromStorage(a.videoID,function(){p.onError(a)});else if(c===p.RESOURCE_STATE.finished)try{p.saveCachedVideo(a),p.deleteTracking(a),p.onDone(a)}catch(b){p.deleteCachedVideoFromStorage(a.videoID,function(){p.onError(a)})}}},trackProgress:function(a){var b=0;for(var c in a.resources)Object.prototype.hasOwnProperty.call(a.resources,c)&&(b+=a.resources[c].progress);a.loaded=b;var d={};d.bytes_downloaded=a.loaded;p.logEventTracking(a,"download_progress",d);return b},sendResourceRequest:function(a,c){var d=new(b("URIDownloader"))(c.src,c.size);a.chunked?d.setChunkedResponseHandler(function(b){try{var d=[];for(var e=0;e<b.length;e++){var f=[],g=p.createPrefix(a.videoID,c.type,e);f.push(g);g=b[e];f.push(g);d.push(f)}h.multiSet(d,function(d){c.chunkCount=b.length,p.updateTracking(a,c,d?p.RESOURCE_STATE.error:p.RESOURCE_STATE.finished)})}catch(b){p.updateTracking(a,c,p.RESOURCE_STATE.error)}}):d.setResponseHandler(function(b){try{var d=p.createPrefix(a.videoID,c.type);h.setItem(d,b,function(b){p.updateTracking(a,c,b?p.RESOURCE_STATE.error:p.RESOURCE_STATE.finished)})}catch(b){p.updateTracking(a,c,p.RESOURCE_STATE.error)}});d.setErrorHandler(function(){p.updateTracking(a,c,p.RESOURCE_STATE.error)});d.setProgressHandler(function(b){b.total&&(c.progress=b.loaded,a.onProgress(p.trackProgress(a),a.totalSize))});d.setAbortHandler(function(){setTimeout(function(){p.updateTracking(a,c,p.RESOURCE_STATE.error)},k)});p.updateTracking(a,c);c.downloader=d;d.sendRequest()},createLogger:function(a){var c={};c.download_origin=a.origin;c.quality=a.quality;c.session_id=a.sessionID;c.total_size=a.totalSize;c.video_id=a.videoID;return new(b("VideoDownloadLogger"))(c)},getLogger:function(a){return!a.logger?null:a.logger},logEvent:function(a,c,d){var e=new(b("VideoDownloadLogger"))();d=d||{};d.video_id=a;a=p.getCachedVideoByID(a);a&&(d.download_origin=a.downloadOrigin,d.session_id=a.sessionID,d.total_size=a.totalSize,d.quality=d.quality?d.quality:a.quality,d.saved_offline=1);e.logEvent(c,d)},logEventTracking:function(a,b,c){var d=this.getLogger(a);c=c||{};Object.prototype.hasOwnProperty.call(c,"reason")||(c.reason=a.downloadReason);if(a.loggingDataCallback){var e=a.loggingDataCallback;c=e(c)}c.elapsed_time_ms=Date.now()-a.downloadStartedTime;d.logEvent(b,c)},onError:function(a,b,c){var d={};d.error_code=b;d.error=c;p.logEventTracking(a,"download_failed",d);a.onError(b)},onDone:function(a){p.logEventTracking(a,"download_finished"),a.onDone()}};e.exports=p}),null);
__d("MVideoDownloadState",[],(function(a,b,c,d,e,f){a={DOWNLOADING:"downloading",DOWNLOADED:"downloaded",DELETING:"deleting",NOTDOWNLOADED:"notdownloaded"};e.exports=a}),null);
__d("MVideoDownloadStateHandler",["MVideoCache","MVideoDownloadState"],(function(a,b,c,d,e,f){var g=null;a=function(){"use strict";function a(){this.$1={},this.$2={}}var c=a.prototype;c.addListener=function(a,b){this.$1[a]||(this.$1[a]=[]),this.$1[a].push(b)};a.removeListeners=function(a){this.$3().$1[a]&&(this.$3().$1[a]=[])};c.setState=function(a,b){a.forEach(function(a){this.$2[a]=b;if(!this.$1[a])return;a=this.$1[a];a.forEach(function(a){try{a.call(window,b)}catch(a){}})},this)};c.getState=function(a){return this.$2[a]};a.$3=function(){g||(g=new a());return g};a.listen=function(a,b){this.$3().addListener(a,b),this.initializeState(a)};a.initializeState=function(c){b("MVideoCache").isVideoDownloaded(c)?a.downloaded([c]):b("MVideoCache").isVideoDownloading(c)?a.downloading([c],b("MVideoCache").getVideoProgressByID(c),b("MVideoCache").getVideoSize(c)):a.deleted([c])};a.getState=function(a){return this.$3().getState(a)};a.downloading=function(a,c,d){this.$3().setState(a,{state:b("MVideoDownloadState").DOWNLOADING,loaded:c,total:d})};a.downloaded=function(a){this.$3().setState(a,{state:b("MVideoDownloadState").DOWNLOADED})};a.cleanup=function(a){this.$3().setState(a,{state:b("MVideoDownloadState").DELETING})};a.deleted=function(a,c){this.$3().setState(a,{state:b("MVideoDownloadState").NOTDOWNLOADED,errorMessage:c})};return a}();e.exports=a}),null);
__d("MVideoPlaybackState",[],(function(a,b,c,d,e,f){a={NORMAL_PLAYBACK:"normalplayback",SLOW_PLAYBACK:"slowplayback",NOT_STARTED_PLAYBACK:"notstartedplayback"};e.exports=a}),null);
__d("Network",["mixInEventEmitter"],(function(a,b,c,d,e,f){var g=!0,h=a.navigator.connection,i={0:"unknown",1:"ethernet",2:"wifi",3:"2g",4:"3g"};function c(){return g}function d(a){if(a==g)return;g=a;l.emit(a?"online":"offline")}function f(){return h?h.bandwidth:g?Infinity:0}function j(){return h?h.metered:!1}function k(){var a=h?String(h.type):"0";return i[a]||a}var l={getBandwidth:f,getType:k,isMetered:j,isOnline:c,setOnline:d};b("mixInEventEmitter")(l,{online:!0,offline:!0});l=l;a.addEventListener?(a.addEventListener("online",d.bind(null,!0)),a.addEventListener("offline",d.bind(null,!1))):a.attachEvent&&(a.attachEvent("online",d.bind(null,!0)),a.attachEvent("offline",d.bind(null,!1)));f=l;e.exports=f}),null);
__d("MVideoUtils",["cx","Bootloader","CSS","DataAttributeUtils","DOM","MLegacyDataStore","Network","getViewportDimensions"],(function(a,b,c,d,e,f,g){var h=.5,i=0,j=null,k=null,l=null,m={PLAY_SIGIL:"playInlineVideo",INSERTION_POINT_SIGIL:"inlineVideo",LOADING_CLASS:"_2nmc",SHOWN_CLASS:"_53mu",SHOWN_CLASS_WITH_DOWNLOAD:"_2qoq",PLAYER_CLASS:"_53mv",FULL_WIDTH_PLAYER_CLASS:"_2c9v",SHOW_PAUSE_CLASS:"_3gzh",SHOW_PLAYING_CLASS:"_7bzf",SPHERICAL_CLASS:"_4a1j",DEBUGGER_CLASS:"_4551",PLAYER_STATE:{playing:"playing",paused:"paused"},API_INSTANCE_KEY:"m_video_player_api_instance_ref",createVideoNode:function(){var a={autobuffer:"true","x-webkit-airplay":"allow",controlslist:"nodownload",disablePictureInPicture:"true"};a=b("DOM").create("video",a);b("CSS").addClass(a,m.FULL_WIDTH_PLAYER_CLASS);b("CSS").addClass(a,m.PLAYER_CLASS);return a},getStoryNode:function(a){return a&&a.getNode("story-div")},_handleLoggingOnPlayWithBootload:function(a,c,d,f){if(j.isLoggedIn()){f=this.getStoryNode(a)||f;if(f){a=b("DataAttributeUtils").getDataFt(f);if(a){f={ft:JSON.parse(a)};if(c){c=c.getLogger();c.setFTData(f)}d.fbid&&d.ownerID&&(a=k.parse(a,e.id),a.video_info={video_id:d.fbid,owner_id:d.ownerID},a=k.stringify(a));new l("/feedtracking/").setMethod("POST").setData({ft_data:a,clicked_uri:d.src,tn:d.trackingNodes}).send()}}}},handleLoggingOnPlay:function(a,c,d,e){b("Bootloader").loadModules(["CurrentUser","FBJSON","MRequest"],function(b,f,g){j=b,k=f,l=g,m._handleLoggingOnPlayWithBootload(a,c,d,e)},"MVideoUtils")},getHumanReadbleSize:function(a){var b=1e3,c=b*b;b=b*b*b;if(a>b)return this.formatNumber(a,b,2)+" GB";else return this.formatNumber(a,c,1)+" MB"},formatNumber:function(a,b,c){return Math.ceil(a/(b/Math.pow(10,c)))/Math.pow(10,c)},getDownloadProgressText:function(a,b){return m.getHumanReadbleSize(a)+" / "+m.getHumanReadbleSize(b)},getDownloadProgressPercentage:function(a,b){a=a/b*100;a=a.toFixed(1);return a.toString()},getConnectivityType:function(){var a=b("Network").getType(),c=null;a=="wifi"||a=="WIFI"?c="WIFI":(a=="cellular"||a=="2g"||a=="3g"||a=="wwan")&&(c="MOBILE");return c},getNetworkBandwidth:function(){var a=null;"connection"in navigator&&("downlinkMax"in navigator.connection&&(a=navigator.connection.downlinkMax));var b=null;try{b=parseFloat(a)}catch(a){}return typeof b!=="number"||isNaN(a)?null:b},getAvailableQualitiesString:function(a){return a&&a.join(", ")},isVisible:function(a){var c=b("getViewportDimensions")().height,d=b("getViewportDimensions")().width;if(a.height===0)return!1;var e=a.y-i+(1-h)*a.height,f=a.y+h*a.height,g=a.x+(1-h)*a.width;a=a.x+h*a.width;return e<0||f>=c||g<0||a>=d?!1:!0},getVideoDataFromMVideo:function(a){return b("MLegacyDataStore").get(a)}};e.exports=m}),null);
__d("guid",[],(function(a,b,c,d,e,f){e.exports=a;function a(){return"f"+(Math.random()*(1<<30)).toString(16).replace(".","")}}),null);
__d("MaybeNativePromise",["Promise"],(function(a,b,c,d,e,f){"use strict";c=a.Promise||b("Promise");b("Promise").resolve();d=c;e.exports=d}),null);
__d("VideoAkamaiRequestHelper",["URI"],(function(a,b,c,d,e,f){"use strict";f.isAkamai=a;f.getRequestHeaders=h;f.getRequestHeadersFromUrl=c;var g;function a(a){return a.toLowerCase().indexOf("akamai")!==-1}function h(a){var b=a.startByte;a=a.endByte;if(b!=void 0&&!(b===0&&a==void 0)){b="bytes="+b+"-"+(a==void 0?"":a);return{Range:b}}return null}function c(a){var c=new(g||(g=b("URI")))(a);c=c.getQueryData();var d=c.startByte;c=c.endByte;return h({baseUrl:a,startByte:d,endByte:c})}}),null);
__d("MVideoDashPrefetchCache",["regeneratorRuntime","Promise","BanzaiODS","Deferred","MaybeNativePromise","MOzExperiments","Run","URI","VideoAkamaiRequestHelper","XHRRequest","getCrossOriginTransport"],(function(a,b,c,d,e,f){var g,h={maxPrefetchVideosNum:0,consolidateFragmentedPrefetchRequest:!1,disablePrefetchCache:!1,enableGlobalSchedulerForPrefetch:!1,prefetchPriority:1,switchPrefetchTaskToHighPriWhenPlayed:!1};function i(a,b,c){var d=a.errorCode;a={name:a.errorType,message:a.errorMsg,type:c,url:b,status:d};return a}function j(a){return a.audio.length+a.video.length+a.manifest.length}function k(a,c){b("BanzaiODS").bumpEntityKey(2966,"mtouch_video_playback","prefetch."+a,c)}function l(a){var b="aborted",c={status:0},d=new Error("Prefetch request aborted.");return Object.assign(d,{type:b,url:a,xhr:c})}function m(a){var c=a.getURI(),d=c.toString();if(b("VideoAkamaiRequestHelper").isAkamai(d)){var e=b("VideoAkamaiRequestHelper").getRequestHeadersFromUrl(d);d=c.removeQueryData(["bytestart","byteend"]);a.setURI(d);e&&Object.keys(e).forEach(function(b){a.setRequestHeader(b,e[b])})}return a}var n=null,o=new Map();function p(a){a=new(g||(g=b("URI")))(a);a=a.getDomain();return a.endsWith("fbcdn.net")&&!a.startsWith("interncache")&&!a.endsWith("ak.fbcdn.net")}function q(a,c){c===void 0&&(c=!1);return c&&p(a)?b("getCrossOriginTransport").withCredentials:b("getCrossOriginTransport")}function r(a){return p(a.url)}function s(a,b,c){return{response:a.slice(b.start+0,b.end+1),responseTime:c}}function t(a){var c=new(g||(g=b("URI")))(a);if(c.getDomain()){c=c.removeQueryData(["oh"]);c=c.removeQueryData("__gda__");var d=Object.keys(c.getQueryData());for(var e=0;e<d.length;e++){var f=d[e];f.startsWith("_nc")&&(c=c.removeQueryData(f))}return c.toString()}return a}a=function(){"use strict";function a(){this.$2=new Map(),this.$1=new Map(),this.$3=[],this.$4=[],this.$5=0,this.$6=h.maxPrefetchVideosNum,this.$7=h.consolidateFragmentedPrefetchRequest}var c=a.prototype;c.$9=function(a,c){var d=this;c===void 0&&(c=!1);var e=a,f=new(b("XHRRequest"))(e).setMethod("GET").setResponseType("arraybuffer").setTransportBuilder(q(e,c));m(f);c=new(b("MaybeNativePromise"))(function(b,c){f.setErrorHandler(function(a){d.$10(f),c(i(a,e,"preload"))}),f.setResponseHandler(function(a){d.$10(f),b(babelHelpers["extends"]({},f,{response:a,initiator:"XHR_REQUEST"}))}),f.setAbortHandler(function(){d.$10(f);var b=l(a);c(b)})});this.$11(a,c);this.$3.push(f);this.$8?this.$8.push(f):f.send();return c};c.genPrefetchMpdNow=function(a){return b("regeneratorRuntime").async(function(b){while(1)switch(b.prev=b.next){case 0:if(!this.has(a)){b.next=2;break}return b.abrupt("return",null);case 2:return b.abrupt("return",this.$9(a));case 3:case"end":return b.stop()}},null,this)};c.$12=function(b,c,d){c===void 0&&(c=!1);d===void 0&&(d=null);var e=[];for(var f=0;f<b.length;f++){var g=a.createQueryStringURL(b[f]);this.has(g)||(e.push(this.$9(g,c).then(function(a){k("received",1);return a})),d!=null&&this.$2.set(g,d))}k("sent",e.length);return e};c.$13=function(c){var d=this,e=a.getConsolidatedURL(c);if(e==null)return this.$12(c);var f=new(b("XHRRequest"))(e).setMethod("GET").setResponseType("arraybuffer").setTransportBuilder(q(e));m(f);var g=Date.now(),h=[];for(var j=0;j<c.length;j++){var l=a.createQueryStringURL(c[j]),n=new(b("Deferred"))();this.has(l)||this.$11(l,n.getPromise());h.push(n)}f.setErrorHandler(function(b){d.$10(f);for(var a=0;a<h.length;a++)h[a].reject(i(b,e,"preload"))});f.setResponseHandler(function(b){var e=Date.now()-g;for(var a=0;a<c.length;a++){var i=h[a],j=c[a];i.resolve(s(b,j,e))}d.$10(f)});f.setAbortHandler(function(){for(var a=0;a<c.length;a++){var b=h[a];b.reject(new Error("Request aborted."))}});this.$3.push(f);f.send();k("consolidated.sent",1);k("sent",h.length);l=h.map(function(a){return a.getPromise().then(function(a){k("received",1);return a})});b("Promise").all(l).then(function(){return k("consolidated.received",1)});return l};c.$14=function(a){var c=this,d=a.useCredentials,e=a.connectionQualityLevel;this.$5++;var f=this.$7&&!d;h.enableGlobalSchedulerForPrefetch&&(this.$8=[]);var g=f?this.$13(a.video):this.$12(a.video,d,e);f=f?this.$13(a.audio):this.$12(a.audio,d,e);e=this.$12(a.manifest,d);var i=g.concat(f,e);if(this.$8){var j=this.$8||[];this.$8=null;var k=""+a.videoID;d={name:"prefetch task, "+k,run:function(){k&&o["delete"](k);j.forEach(function(a){return a.send()});return b("MaybeNativePromise").all(i).then(function(){})["catch"](function(){})},cancel:function(){}};d.run();b("MaybeNativePromise").all(i).then(function(){return c.$15()})["catch"](function(){return c.$15()})}else b("MaybeNativePromise").all(i).then(function(){return c.$15()})["catch"](function(){return c.$15()})};c.$11=function(a,c){var d=this;a=t(a);this.$1.values().next().done&&b("Run").onLeave(function(){for(var a=0;a<d.$3.length;a++)d.$3[a].abort();d.$3=[];d.$4=[];d.$5=0;d.$1.clear()});this.$1.set(a,c)};c.$10=function(a){a=this.$3.indexOf(a);a>-1&&this.$3.splice(a,1)};c.$15=function(){this.$5--;var a=this.$4.shift();a&&this.$14(a)};c.has=function(a){a=t(a);return this.$1.has(a)};c.getConnectionQualityLevel=function(a){return this.$2.get(a)};c.get=function(a){a=t(a);var c=this.$1.get(a);c?k("cache.hit",1):k("cache.miss",1);b("MOzExperiments").mtouch_reuse_cache_values||this.$1["delete"](a);k("retrieve",1);return c};c.queueRequestBatch=function(a){this.$6===0||this.$5<this.$6?this.$14(a):(k("queued",j(a)),this.$4.push(a))};a.getInstance=function(){n===null&&(n=new a());return n};a.createQueryStringURL=function(a){var c=a.url,d=a.start;a=a.end;d!==null&&d!==void 0&&a!==null&&a!==void 0&&(c=new(g||(g=b("URI")))(c).addQueryData({bytestart:d,byteend:a}));return c.toString()};a.getConsolidatedURL=function(b){var c="",d=Infinity,e=0;for(var f=0;f<b.length;f++){var g=b[f],h=g.url,i=g.start;g=g.end;if(h==null||i==null||g==null)return null;if(c==="")c=h;else if(c!==h)return null;d=Math.min(d,i);e=Math.max(e,g)}return a.createQueryStringURL({url:c,start:d,end:e})};a.loadVideo=function(c,d,e){d=!!d;if(h.disablePrefetchCache||b("MOzExperiments").disable_prefetch)return;var f=a.getInstance();c.manifest||(c.manifest=[]);f.queueRequestBatch({manifest:c.manifest.filter(r),video:c.video.filter(r),audio:c.audio.filter(r),videoID:c.videoID,useCredentials:d,connectionQualityLevel:e})};a.getCacheValue=function(b){var c=a.getInstance().get(b),d=!1;b=b.match(/bytestart=(\d+)/);if(b){b=parseInt(b[1],10);b<5e3&&(d=!0)}d&&k("consume."+(c?"hit":"miss"),1);return c};a.getConnectionQualityLevel=function(b){return a.getInstance().getConnectionQualityLevel(b)};a.hasCacheValue=function(b){return a.getInstance().has(b)};a.getPrefetchTaskByID=function(a){a=o.get(a)||null;return a};return a}();e.exports=a}),null);